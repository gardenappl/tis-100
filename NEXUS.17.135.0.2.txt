@0
MOV 0,DOWN
INF:MOV RIGHT,DOWN
    JMP INF

@1
    MOV 1,RIGHT#RE
SCN:MOV UP,ACC
    JNZ SEQ
    MOV 5,RIGHT#MI
    MOV RIGHT,DOWN
-IN:JRO DOWN
SEQ:MOV ACC,LEFT
    MOV 5,RIGHT#MI
    SUB RIGHT
    JGZ SCN
    MOV 3,RIGHT#AD
    MOV ACC,RIGHT
    JMP SCN

@2
    MOV 0,DOWN
-IN:JRO LEFT
RES:MOV 999,ACC
    JMP -IN
ADD:ADD LEFT
    JMP -IN
MIN:MOV ACC,LEFT
    JMP -IN

@3
BEG:MOV UP,DOWN
SCN:MOV LEFT,ACC
    MOV ACC,DOWN
    JEZ END
    MOV ACC,RIGHT
    JMP SCN
END:MOV 0,LEFT
RET:MOV RIGHT,ACC
    JNZ RDO
    MOV 0,RIGHT
    JMP SCN
RDO:MOV ACC,LEFT
    JMP RET

@4
-IN:JRO RIGHT
RES:MOV 1,ACC#NFN
    JMP -IN
SET:MOV 3,ACC#FND
    JMP -IN
GET:MOV ACC,RIGHT

@5
BEG:MOV 3,RIGHT#SE
    MOV UP,RIGHT
    MOV 1,LEFT#RES
SEQ:MOV UP,ACC
    JEZ END
    MOV 1,RIGHT#GE
    SUB RIGHT
    JNZ SEQ
    MOV 3,LEFT#SET
    JMP SEQ
END:MOV 5,LEFT#GET
-FL:JRO LEFT
NFN:MOV 1,RIGHT#GE
    MOV RIGHT,DOWN
FND:MOV 5,RIGHT#IN

@6
-IN:JRO LEFT
GET:MOV ACC,LEFT
    JMP -IN
SET:MOV LEFT,ACC
    JMP -IN
INC:ADD 1
    JMP -IN