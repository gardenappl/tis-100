@0


@1
BEG:MOV UP,ACC
    MOV ACC,RIGHT
    MOV ACC,RIGHT
-IN:JRO RIGHT
NSW:MOV ACC,DOWN
    JMP BEG
SWP:MOV ACC,RIGHT
    MOV RIGHT,DOWN

@2
BEG:MOV UP,ACC
    SUB LEFT
    JLZ SWP
    ADD LEFT
    MOV ACC,DOWN
    MOV 1,LEFT#NSW
    JMP BEG
SWP:MOV LEFT,DOWN
    MOV 3,LEFT#SWP
    ADD LEFT
    MOV ACC,LEFT

@3


@4
MOV UP,ACC
MOV ACC,RIGHT
MOV ACC,DOWN

@5
BEG:MOV UP,ACC
    SUB LEFT
BIG:SUB 30
    MOV 10,DOWN#BI
    JGZ BIG
    JLZ MOD
    MOV 2,DOWN#EXA
    MOV ACC,RIGHT
    JMP BEG
MOD:ADD 30
    MOV 1,DOWN#MOD
    MOV ACC,RIGHT

@6
BEG:MOV LEFT,ACC
SML:SUB 2
    MOV 8,DOWN#SML
    JGZ SML
    JLZ MOD
    MOV 4,DOWN#EXA
    JMP BEG
MOD:MOV 3,DOWN#MOD

@7


@8
MOV UP,ACC
MOV RIGHT,NIL
MOV ACC,RIGHT

@9
-IN:JRO ANY
MOD:SUB 15
EXA:MOV 0,LEFT
    ADD LEFT
    MOV 1,RIGHT#AD
    MOV ACC,RIGHT
    MOV 0,ACC
    JMP -IN
END:MOV RIGHT,DOWN
   !JMP -IN
BIG:ADD 15

@10
-IN:JRO ANY
ADD:ADD LEFT
    JMP -IN
MOD:SUB 1
EXA:MOV 8,LEFT#END
    MOV ACC,LEFT
    MOV 0,ACC
    JMP -IN
SML:ADD 1