@0
BEG:MOV UP,ACC
    JEZ END
    SWP
    ADD 1
    SWP
    MOV ACC,RIGHT
    JMP BEG
END:SWP
CNT:MOV ACC,DOWN
    SUB 1
    JEZ BEG
    JMP CNT

@1
BEG:MOV DOWN,ACC
    SUB DOWN
    JGZ MOV
    SWP
    JGZ SKP
    MOV 1,ACC
    SWP
    MOV DOWN,NIL
    JMP BEG
SKP:SWP
MOV:ADD DOWN
    MOV ACC,LEFT

@2


@3
BEG:MOV UP,ACC
   !SAV
SCN:JEZ END
    MOV 3,RIGHT#SC
    MOV RIGHT,DOWN
    SUB 1
    JMP SCN
END:MOV 11,RIGHT#E
   !SWP
    MOV 1,RIGHT#LE
    MOV ACC,RIGHT
    MOV 100,ACC
IDL:SUB 1
    JGZ IDL
   !MOV -1,RIGHT#R

@4
RES:MOV 5,RIGHT#RE
-IN:JRO LEFT
LEN:MOV LEFT,DOWN
    JMP -IN
SCN:MOV UP,ACC
    MOV ACC,LEFT
    MOV 1,RIGHT#MI
    SUB RIGHT
    JGZ -IN
NEW:MOV 3,RIGHT#NE
    MOV ACC,RIGHT
    JMP -IN
END:MOV 1,RIGHT#MI
    MOV RIGHT,DOWN
    JMP -IN

@5
-IN:JRO ANY
MIN:MOV ACC,LAST
    JMP -IN
NEW:ADD LAST
    JMP -IN
RES:MOV 999,ACC
    JMP -IN
RET:MOV DOWN,UP
    MOV ACC,UP
    MOV ACC,UP

@6


@7
BEG:MOV UP,DOWN
    MOV UP,ACC
    SUB 1
    JEZ SEQ
RET:MOV LEFT,RIGHT
    SUB 1
    JLZ BEG
    JMP RET
SEQ:MOV LEFT,NIL
    MOV 0,DOWN

@8
BEG:MOV LEFT,ACC
    MOV 7,UP#RET
    MOV ACC,UP