@0
    MOV 0,DOWN
BEG:MOV 3,RIGHT#SE
    MOV RIGHT,ACC
    JEZ END
    MOV ACC,DOWN
    SUB RIGHT
    JGZ BEG
    MOV 1,RIGHT#AM
    MOV ACC,RIGHT
    JMP BEG
END:MOV RIGHT,NIL
   !MOV 6,RIGHT#EN
    JMP BEG

@1
    MOV 999,ACC
-IN:JRO LEFT
AMI:ADD LEFT
    JMP -IN
SEQ:MOV UP,LEFT
    MOV ACC,LEFT
    JMP -IN
END:MOV 1,DOWN#GO
-DN:JRO DOWN
MIN:MOV ACC,DOWN
    JMP -DN
INC:ADD 1
    JMP -DN
FIN:MOV ACC,DOWN

@2


@3
-IN:JRO UP
GO: MOV LEFT,ACC
    JEZ END
    MOV ACC,RIGHT
    MOV 1,UP#MIN
    SUB UP
    JNZ GO
    MOV 1,DOWN#FND
    JMP GO
END:MOV 3,DOWN#END
-DN:JRO DOWN
INC:MOV 3,UP#INC
    JMP GO
FIN:MOV 5,UP#FIN
    MOV UP,DOWN

@4
MOV RIGHT,UP

@5
-IN:JRO ANY
FND:MOV 1,ACC
    JMP -IN
END:MOV 0,LEFT
    JGZ EFD
    MOV 1,RIGHT#CL
    MOV 3,UP#FIN
    MOV UP,DOWN
    JMP -IN
EFD:MOV 0,ACC
    MOV 4,RIGHT#FN
    JMP -IN
EMO:MOV 1,UP#INC
    JMP -IN
MOV:MOV RIGHT,LEFT

@6
ZER:MOV 0,UP
-IN:JRO LEFT
CLR:MOV UP,ACC
    JNZ CLR
    JMP ZER
FND:MOV UP,ACC
    JEZ END
    MOV 14,LEFT#MO
    MOV ACC,LEFT
    JMP FND
END:MOV 0,UP
    MOV 12,LEFT#EM
    JMP -IN