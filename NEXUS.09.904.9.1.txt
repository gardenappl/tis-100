@0
-IN:JRO DOWN
BEG:MOV UP,ACC
    JEZ END
    MOV -1,LEFT
GET:SUB 1
    MOV RIGHT,LEFT
    JGZ GET
    MOV LEFT,ACC
    ADD 1
    MOV ACC,RIGHT
RET:MOV LEFT,ACC
    JLZ BEG
    MOV ACC,RIGHT
    JMP RET
END:MOV 1,DOWN#SEQ

@1


@2
    MOV 7,RIGHT#IN
    MOV 20,ACC
IDL:SUB 1
    JGZ IDL
BEG:MOV 1,UP#BEG
-IN:JRO ANY
SEQ:MOV 1,RIGHT#MA
    JMP -IN
END:MOV 7,RIGHT#IN
    MOV 50,ACC
ID2:SUB 1
    JGZ ID2
   #MOV 12,DOWN#WR
    JMP BEG

@3
-IN:JRO LEFT
!MAX:MOV 5,ACC
GET:MOV UP,DOWN
    SUB 1
    JGZ GET
    MOV -1,DOWN
    MOV 3,LEFT#END
    JMP -IN
INI:MOV 5,ACC
PUT:MOV 0,UP
    SUB 1
    JGZ PUT

@4
-IN:JRO RIGHT
GEM:SWP
    MOV ACC,RIGHT
    SWP
    JMP -IN
GEI:MOV ACC,RIGHT
    JMP -IN
NOI:MOV 0,ACC
    JMP -IN
NEW:ADD RIGHT
    SWP
    MOV ACC,RIGHT
    SWP

@5
BEG:MOV 1,RIGHT#GE
    MOV RIGHT,ACC
    MOV 1,LEFT#GEM
    SUB LEFT
    JEZ NOI
    JGZ NEW
    JMP BEG
NOI:MOV 8,LEFT#GEI
    JMP BEG
NEW:MOV

@6
-IN:JRO LEFT
GET:MOV UP,LEFT
    ADD 1
    JMP -IN
IND:MOV ACC,LEFT
    JMP -IN