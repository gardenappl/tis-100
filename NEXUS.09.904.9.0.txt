@0
-IN:JRO DOWN
BEG:MOV UP,ACC
    JEZ END
    MOV -1,LEFT
GET:SUB 1
    MOV RIGHT,LEFT
    JGZ GET
    MOV LEFT,ACC
    ADD 1
    MOV ACC,RIGHT
RET:MOV LEFT,ACC
    JLZ BEG
    MOV ACC,RIGHT
    JMP RET
END:MOV 1,DOWN#SEQ

@1


@2
    MOV 11,RIGHT#I
    MOV 20,ACC
IDL:SUB 1
    JGZ IDL
BEG:MOV 1,UP#BEG
-IN:JRO ANY
SEQ:MOV 1,RIGHT#MA
    JMP -IN
END:MOV 11,RIGHT#I
    MOV 50,ACC
ID2:SUB 1
    JGZ ID2
    MOV 12,DOWN#WR
    JMP BEG

@3
-IN:JRO LEFT
!MAX:MOV 5,ACC
GET:SUB 6
    NEG
    MOV ACC,DOWN
    NEG
    MOV UP,DOWN
    ADD 5
    JGZ GET
    MOV 3,LEFT#END
    JMP -IN
INI:MOV 5,ACC
PUT:MOV 0,UP
    SUB 1
    JGZ PUT

@4


@5
-IN:JRO ANY
GMA:SWP
    MOV ACC,RIGHT
    SWP
    JMP -IN
NOI:MOV 0,ACC
    JMP -IN
NEW:SWP
    ADD RIGHT
    SWP
    MOV RIGHT,ACC
    JMP -IN
WRT:MOV ACC,DOWN
    MOV 0,ACC
    SWP

@6
GET:SWP
    MOV UP,ACC
    SWP
    MOV UP,ACC
   !MOV 1,LEFT#GMA
    SUB LEFT
    JEZ NOI
    JGZ NEW
    JMP GET
NOI:MOV 5,LEFT#NOI
    JMP GET
NEW:MOV 7,LEFT#NEW
    MOV ACC,LEFT
    SWP
    MOV ACC,LEFT