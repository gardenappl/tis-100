@0
BEG:MOV UP,ACC
    JEZ END
    SWP
    ADD 1
    SWP
    MOV ACC,RIGHT
    JMP BEG
END:SWP
CNT:MOV ACC,DOWN
    SUB 1
    JEZ BEG
    JMP CNT

@1
BEG:MOV DOWN,ACC
    JLZ END
    SUB DOWN
    JGZ MOV
    SWP
    JGZ SKP
    MOV 1,ACC
    SWP
    MOV DOWN,NIL
    JMP BEG
END:SAV
    JMP BEG
SKP:SWP
MOV:ADD DOWN
    MOV ACC,LEFT

@2


@3
BEG:MOV UP,ACC
   !SAV
SCN:JEZ END
    MOV 1,RIGHT#SC
    MOV RIGHT,DOWN
    SUB 1
    JMP SCN
END:MOV 9,RIGHT#E
    SWP
    MOV ACC,RIGHT
    MOV RIGHT,NIL
    MOV 20,ACC
IDL:SUB 1
    JGZ IDL

@4
RES:MOV 5,RIGHT#RE
-IN:JRO LEFT
SCN:MOV UP,ACC
    MOV ACC,LEFT
    MOV 1,RIGHT#MI
    SUB RIGHT
    JGZ -IN
NEW:MOV 3,RIGHT#NE
    MOV ACC,RIGHT
    JMP -IN
END:MOV 1,RIGHT#MI
    MOV RIGHT,DOWN
    MOV LEFT,DOWN
    MOV DOWN,LEFT

@5
-IN:JRO ANY
MIN:MOV ACC,LAST
    JMP -IN
NEW:ADD LAST
    JMP -IN
RES:MOV 999,ACC
    JMP -IN
SEQ:MOV -1,UP
    JMP -IN
RET:MOV DOWN,UP
    MOV ACC,UP
    MOV ACC,UP

@6


@7
BEG:MOV UP,DOWN
    MOV UP,ACC
    SUB 1
    JEZ SEQ
RET:MOV 3,RIGHT#RE
    MOV LEFT,RIGHT
    SUB 1
    JLZ END
    JMP RET
END:MOV 1,RIGHT#S
    MOV 0,UP
    JMP BEG
SEQ:MOV LEFT,NIL
    MOV 0,DOWN
    MOV 0,UP

@8
-IN:JRO LEFT
SEQ:MOV 7,UP#SEQ
    JMP -IN
RET:MOV LEFT,ACC
    MOV 9,UP#RET
    MOV ACC,UP